#!/usr/bin/env python
# -*- coding: utf-8 -*-
#-------------------------------------------------------------------------------
# This is the main HDTV application.
#-------------------------------------------------------------------------------

# Load required modules
import sys
import os.path
import ROOT

# Get ~/.hdtv directory
hdtvpath = os.path.expanduser("~/.hdtv")
if not os.path.exists(hdtvpath):
	raise RuntimeError, "Failed to load core plugins: directory ~/.hdtv not found."

# Set the python path
sys.path.append(hdtvpath)
sys.path.append(hdtvpath + "/plugins")

# Import core modules
import hdtv.dlmgr
hdtv.dlmgr.path.append(hdtvpath + "/lib")
import hdtv.cmdline
hdtv.cmdline.ReadReadlineInit(hdtvpath + "/inputrc")
hdtv.cmdline.SetReadlineHistory(hdtvpath + "/hdtv_history")
hdtv.cmdline.SetInteractiveDict(locals())
# import hdtv.config

# Execute startup script
import startup


## Debug
#from hdtv.manager import ObjectManager
#mn = ObjectManager()

#import hdtv.spectrum
## Don't add created spectra to the ROOT directory
#ROOT.TH1.AddDirectory(ROOT.kFALSE)
#spec0 = hdtv.spectrum.Spectrum.FromFile("/home/tanja/hdtv/test/tanja/spectra/231Th_7up.ascii")
#spec1 = hdtv.spectrum.Spectrum.FromFile("/home/tanja/hdtv/test/tanja/spectra/231Th_7down.ascii")
#spec2 = hdtv.spectrum.Spectrum.FromFile("/home/tanja/hdtv/test/tanja/spectra/231Th_20up.ascii")
#spec3 = hdtv.spectrum.Spectrum.FromFile("/home/tanja/hdtv/test/tanja/spectra/231Th_20down.ascii")
#mn[0]=spec0
#mn[1]=spec1
#mn[2]=spec2
#mn[3]=spec3


# Go
hdtv.cmdline.MainLoop()

