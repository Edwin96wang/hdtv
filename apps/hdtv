#!/usr/bin/env python
# -*- coding: utf-8 -*-
#-------------------------------------------------------------------------------
# This is the main HDTV application.
#-------------------------------------------------------------------------------

# Load required modules
import sys
import os.path
import ROOT

# Get ~/.hdtv directory
hdtvpath = os.path.expanduser("~/.hdtv")
if not os.path.exists(hdtvpath):
	raise RuntimeError, "Failed to load core plugins: directory ~/.hdtv not found."

# Set the python path
sys.path.append(hdtvpath)
sys.path.append(hdtvpath + "/plugins")

# Import core modules
import hdtv.dlmgr
hdtv.dlmgr.path.append(hdtvpath + "/lib")
import hdtv.cmdline
hdtv.cmdline.ReadReadlineInit(hdtvpath + "/inputrc")
hdtv.cmdline.SetReadlineHistory(hdtvpath + "/hdtv_history")
hdtv.cmdline.SetInteractiveDict(locals())
# import hdtv.config

import hdtv.window
import hdtv.drawable 
import specInterface 
import fitInterface 

window = hdtv.window.Window() 
spectra = hdtv.drawable.DrawableCompound(window.fViewport)

s = specInterface.SpecInterface(window, spectra)
f = fitInterface.FitInterface(window, spectra)

# for debugging
#import glob
#s.LoadSpectra('/home/tanja/hdtv/test/spectra/60Co_gamma.lc2')
#numbers = [35, 40, 45]
#for n in numbers:
#	ids = s.LoadSpectra('/home/tanja/hdtv/test/spectra/231Th_%s*.ascii' % n)
#	cal = s.CalFromFile('/home/tanja/hdtv/test/spectra/231Th_%s.tvcal' %n)
#	for i in ids:
#		spectra[i].SetCal(cal)
	
# Go
hdtv.cmdline.MainLoop()

